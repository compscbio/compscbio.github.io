<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Homework #6 &mdash; cscb2022  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Homework #5" href="HW_05.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> cscb2022
            <img src="../_static/CSCB_logo2.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Schedule</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../schedule.html">Schedule overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../schedule.html#homework-and-final-project-due-dates">Homework and final project due dates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../schedule.html#lecture-schedule">Lecture schedule</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Lectures:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../day/01_history_of_stem_cells.html">History of Stem Cells</a></li>
<li class="toctree-l1"><a class="reference internal" href="../day/02_introduction_to_python_part_1.html">Comp Lesson 1: Introduction to Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../day/03_introduction_to_python_part_2.html">Comp Lesson 2: Introduction to Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../day/04_Till_McCulloch.html">Till and McCulloch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../day/05_scRNAseq_data_generation.html">scRNAseq data generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../day/06_scRNAseq_analysis.html">scRNAseq analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../day/07_scRNAseq_analysis_part_2.html">scRNAseq analysis part 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../day/08_cell_identity.html">Cell identity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../day/09_trajectory_inference.html">Trajectory inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../day/10_TI_part_2.html">How to do TI analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../day/11_stemness.html">How to do ‘Stemness’ analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../day/12_RNA_velocity.html">RNA Velocity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../day/13_scvelo.html">RNA velocity analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../day/14_Lineage_tracing.html">Lineage tracing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../day/15_Pluripotency.html">Pluripotency</a></li>
<li class="toctree-l1"><a class="reference internal" href="../day/16_Spatial_Cell-to-Cell.html">Spatial transcriptomics &amp; Cell-to-cell communication</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Homework</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="HW_01.html">Homework #1</a></li>
<li class="toctree-l1"><a class="reference internal" href="HW_02.html">Homework #2</a></li>
<li class="toctree-l1"><a class="reference internal" href="HW_03.html">Homework #3</a></li>
<li class="toctree-l1"><a class="reference internal" href="HW_04.html">Homework #4</a></li>
<li class="toctree-l1"><a class="reference internal" href="HW_05.html">Homework #5</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Homework #6</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Background:">Background:</a></li>
<li class="toctree-l2"><a class="reference internal" href="#The-data">The data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Your-mission:">Your mission:</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Bonus-(i.e. extra-credit)">Bonus (i.e. extra credit)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Important-notes:">Important notes:</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">cscb2022</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Homework #6</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/homework/HW_06.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Homework-#6">
<h1>Homework #6<a class="headerlink" href="#Homework-#6" title="Permalink to this headline"></a></h1>
<p>Due 11:59 pm EST, Friday April 8th, 2022.</p>
<p>Email your solutions (both .ipnb and .html files) to: <a class="reference external" href="mailto:compscbio&#37;&#52;&#48;gmail&#46;com">compscbio<span>&#64;</span>gmail<span>&#46;</span>com</a>.</p>
<section id="Background:">
<h2>Background:<a class="headerlink" href="#Background:" title="Permalink to this headline"></a></h2>
<p>A wise, less-sadistic post-doc in your collaborator’s lab has generated scRNAseq data from HSPCs <em>exactly</em> as was done in the Weinreb et al 2020 paper. (in fact, it is the same data). She has asked you to analyze it using CoSpar to address the two questions listed below.</p>
</section>
<section id="The-data">
<h2>The data<a class="headerlink" href="#The-data" title="Permalink to this headline"></a></h2>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://compstemcellbio.s3.amazonaws.com/2022/homework/06/adata_cospar_hspc.h5ad">scRNAseq data of hematopoietic stem with lineage barcodes</a> This is the raw counts data, as well as lineage barcodes, as we discussed in the lineage tracing lectures.</p></li>
<li><p>There is <em>no</em> second data set for this homework.</p></li>
</ol>
</section>
<section id="Your-mission:">
<h2>Your mission:<a class="headerlink" href="#Your-mission:" title="Permalink to this headline"></a></h2>
<p>Analyze the data to answer the following questions</p>
<p>1.) What genes distinguish undifferentiated cells biased towards erythrocytes versus megakaryocytes?</p>
<p>2.) What genes distinguish undifferentiated cells biased towards erythrocytes AND megakaryocytes versus those undifferentiated cells biased towards monocytes AND neutrophils?</p>
</section>
<section id="Bonus-(i.e. extra-credit)">
<h2>Bonus (i.e. extra credit)<a class="headerlink" href="#Bonus-(i.e. extra-credit)" title="Permalink to this headline"></a></h2>
<p>3.) What genes distinguish the most multipotent cells from more fate bound but still undifferentiated cells?</p>
<p>4.) Are any signaling pathways enriched in any of the differential expression analyses that you performed in #1-#3? The underlying hypothesis here is that fate biases result from exposure to different signaling mileus. You might explore this using GSEAPY or using the <code class="docutils literal notranslate"><span class="pre">sc.tl.score_genes()</span></code>. Here is a <a class="reference external" href="https://compstemcellbio.s3.amazonaws.com/2022/data/signaling_pathway_targets_040122.joblib">list of signaling pathway targets</a>, which might be helpful. It was derived as described in <a class="reference external" href="https://pubmed.ncbi.nlm.nih.gov/35090587/">Emily
Su’s paper</a>. You can load this dict object with the following code</p>
<p><code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">joblib</span> <span class="pre">import</span> <span class="pre">dump,</span> <span class="pre">load</span> <span class="pre">sigPathTargets</span>&#160; <span class="pre">=</span> <span class="pre">load(&quot;signaling_pathway_targets_040122.joblib&quot;)</span></code></p>
</section>
<section id="Important-notes:">
<h2>Important notes:<a class="headerlink" href="#Important-notes:" title="Permalink to this headline"></a></h2>
<p>1.) The first time that you run a CoSpar analysis, run the <code class="docutils literal notranslate"><span class="pre">cs.hf.set_up_folders()</span></code> function. This will set up some directories that CoSpar assumes are in place.</p>
<p>2.) To answer these questions, you will need to identify the undifferentiated cells that are likely to transition to either of these lineages. Please look at the updated Jupyter Notebook for CoSpar analysis as it contains some code that we did not cover in class to specifcially isolate fate biased progenitors.</p>
<p>3.) You may need to adjust some parameters such as sum_fate_prob_thresh in the <code class="docutils literal notranslate"><span class="pre">tl.fate_bias()</span></code>. Same is true when defining differentially expressed genes.</p>
<p>4.) The CoSpar documentation might be helpful if you get stuck or want to dig deeper.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="HW_05.html" class="btn btn-neutral float-left" title="Homework #5" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Patrick Cahan.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-LFQLTP4DZG"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-LFQLTP4DZG', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>